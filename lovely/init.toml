[manifest]
version = "1.0.0"
dump_lua = true
priority = 0

# Game:update
[[patches]]
[patches.pattern]
target = "game.lua"
position = "before"
pattern = "if self.STATE == self.STATES.PLAY_TAROT then"
payload = """
if G.STATE == G.STATES.DRAW_TO_HAND
or G.STATE == G.STATES.HAND_PLAYED
or G.STATE == G.STATES.ROUND_EVAL
or G.STATE == G.STATES.PLAY_TAROT
or G.STATE == G.STATES.BLIND_SELECT
or G.STATE == G.STATES.SELECTING_HAND then
  SuikaLatro.f.update(dt)
end
"""
match_indent = true
overwrite = false

# Game:draw
[[patches]]
[patches.pattern]
target = "game.lua"
position = "before"
pattern = "timer_checkpoint('uiboxes', 'draw')"
payload = """
--[[if G.STATE == G.STATES.DRAW_TO_HAND
or G.STATE == G.STATES.HAND_PLAYED
or G.STATE == G.STATES.ROUND_EVAL
or G.STATE == G.STATES.GAME_OVER
or G.STATE == G.STATES.PLAY_TAROT
or G.STATE == G.STATES.BLIND_SELECT
or G.STATE == G.STATES.SELECTING_HAND then]]
if SuikaLatro.world_T.y < 15 and G.STATE ~= G.STATES.MENU then
  SuikaLatro.f.draw()
end
"""
match_indent = true
overwrite = false

# set default hand size (ball queue) to 3
[[patches]]
[patches.pattern]
target = "functions/misc_functions.lua"
position = "at"
pattern = "hand_size = 8,"
payload = """
hand_size = 3,
"""
match_indent = true
overwrite = false